<!doctype html>
<html lang="pt-BR">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pizzaria Rodrigues - Pedido Digital</title>
  <script src="/_sdk/element_sdk.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
        body {
            box-sizing: border-box;
        }
        
        .category-card {
            transition: all 0.3s ease;
            border-left: 4px solid transparent;
        }
        
        .category-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }
        
        .menu-item {
            transition: all 0.2s ease;
        }
        
        .menu-item:hover {
            background-color: rgba(139, 69, 19, 0.05);
        }
        
        .quantity-btn {
            transition: all 0.2s ease;
        }
        
        .quantity-btn:hover {
            transform: scale(1.1);
        }
        
        .cart-item {
            animation: slideIn 0.3s ease;
        }
        
        @keyframes slideIn {
            from { opacity: 0; transform: translateX(20px); }
            to { opacity: 1; transform: translateX(0); }
        }
        
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            animation: toastSlide 0.3s ease;
        }
        
        @keyframes toastSlide {
            from { opacity: 0; transform: translateX(100%); }
            to { opacity: 1; transform: translateX(0); }
        }
        
        .shake {
            animation: shake 0.5s ease-in-out;
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        @keyframes bounce-in {
            0% { transform: scale(0.3) translateY(-50px); opacity: 0; }
            50% { transform: scale(1.05) translateY(0); }
            70% { transform: scale(0.9); }
            100% { transform: scale(1); opacity: 1; }
        }
        
        .animate-bounce-in {
            animation: bounce-in 0.6s ease-out;
        }

        /* Ocultar elementos de edi√ß√£o */
        .canva-edit-controls,
        .canva-edit-panel,
        [data-canva-editable],
        .edit-mode-controls {
            display: none !important;
            visibility: hidden !important;
        }
    </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
 </head>
 <body class="min-h-full">
  <div id="app" class="min-h-full bg-gradient-to-br from-orange-50 to-red-50"><!-- Header -->
   <header class="bg-white shadow-lg border-b-4 border-orange-500">
    <div class="max-w-6xl mx-auto px-4 py-6">
     <div class="text-center">
      <h1 class="text-4xl font-bold text-gray-800 mb-2">üçï Pizzaria Rodrigues</h1>
      <p class="text-lg text-gray-600">Bem-vindos ao sabor aut√™ntico da nossa cozinha!</p>
      <div class="mt-4 bg-gradient-to-r from-orange-100 to-red-100 rounded-lg p-4 inline-block">
       <p class="text-sm font-medium text-orange-800 mb-3">üì± <strong>Link Personalizado:</strong> PizzariaRodriguespedidodigital</p><!-- Link Clic√°vel -->
       <div class="bg-white rounded-lg p-3 border-2 border-orange-300">
        <p class="text-xs text-gray-600 mb-2">üîó <strong>Link direto para pedidos:</strong></p>
        <div class="flex items-center space-x-2"><input type="text" id="direct-link" readonly value="https://pizzariarodrigues.com.br/PizzariaRodriguespedidodigital" class="flex-1 p-2 bg-gray-50 border border-gray-300 rounded text-xs font-mono text-blue-600"> <button onclick="copyDirectLink()" class="bg-orange-500 text-white px-3 py-2 rounded hover:bg-orange-600 transition-colors text-xs"> üìã Copiar </button>
        </div>
        <div class="mt-2 flex space-x-2"><button onclick="shareWhatsApp()" class="bg-green-500 text-white px-3 py-1 rounded text-xs hover:bg-green-600 transition-colors"> üì± Compartilhar WhatsApp </button> <button onclick="shareGeneral()" class="bg-blue-500 text-white px-3 py-1 rounded text-xs hover:bg-blue-600 transition-colors"> üì§ Compartilhar </button>
        </div>
       </div>
       <p class="text-xs text-orange-600 mt-2">‚ú® Seus clientes clicam no link e fazem pedidos diretamente!</p>
      </div>
     </div>
    </div>
   </header>
   <div class="max-w-6xl mx-auto px-4 py-8">
    <div class="grid lg:grid-cols-3 gap-8"><!-- Menu Principal -->
     <div class="lg:col-span-2">
      <div class="bg-white rounded-xl shadow-lg p-6">
       <div class="flex justify-between items-center mb-6 border-b-2 border-orange-200 pb-3">
        <h2 class="text-2xl font-bold text-gray-800">üçΩÔ∏è Nosso Card√°pio</h2><button onclick="requestAdminAccess()" class="bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors text-sm"> üë®‚Äçüíº Painel Admin </button>
       </div><!-- Entradas -->
       <div class="category-card bg-gradient-to-r from-yellow-50 to-orange-50 rounded-lg p-6 mb-6 border-l-4 border-yellow-500">
        <h3 class="text-xl font-semibold text-gray-800 mb-4 flex items-center"><span class="bg-yellow-500 text-white rounded-full w-8 h-8 flex items-center justify-center text-sm mr-3">ü•ó</span> Entradas</h3>
        <div class="space-y-3">
         <div class="menu-item flex justify-between items-center p-3 rounded-lg border border-yellow-200">
          <div>
           <h4 class="font-medium text-gray-800">Bruschetta Especial</h4>
           <p class="text-sm text-gray-600">P√£o italiano, tomate, manjeric√£o e queijo</p>
          </div>
          <div class="flex items-center space-x-2"><span class="font-bold text-yellow-700">R$ 45</span> <button onclick="addToCart('Bruschetta Especial', 'Entradas', 45)" class="quantity-btn bg-yellow-500 text-white px-3 py-1 rounded-full text-sm hover:bg-yellow-600"> Adicionar </button>
          </div>
         </div>
         <div class="menu-item flex justify-between items-center p-3 rounded-lg border border-yellow-200">
          <div>
           <h4 class="font-medium text-gray-800">Antipasto da Casa</h4>
           <p class="text-sm text-gray-600">Sele√ß√£o de frios, queijos e azeitonas</p>
          </div>
          <div class="flex items-center space-x-2"><span class="font-bold text-yellow-700">R$ 55</span> <button onclick="addToCart('Antipasto da Casa', 'Entradas', 55)" class="quantity-btn bg-yellow-500 text-white px-3 py-1 rounded-full text-sm hover:bg-yellow-600"> Adicionar </button>
          </div>
         </div>
        </div>
       </div><!-- Pizzas -->
       <div class="category-card bg-gradient-to-r from-red-50 to-orange-50 rounded-lg p-6 mb-6 border-l-4 border-red-500">
        <h3 class="text-xl font-semibold text-gray-800 mb-4 flex items-center"><span class="bg-red-500 text-white rounded-full w-8 h-8 flex items-center justify-center text-sm mr-3">üçï</span> Pizzas Tradicionais</h3>
        <div class="space-y-3">
         <div class="menu-item flex justify-between items-center p-3 rounded-lg border border-red-200">
          <div>
           <h4 class="font-medium text-gray-800">Margherita</h4>
           <p class="text-sm text-gray-600">Molho de tomate, mussarela e manjeric√£o</p>
          </div>
          <div class="flex items-center space-x-2"><span class="font-bold text-red-700">R$ 75</span> <button onclick="addToCart('Pizza Margherita', 'Pizzas', 75)" class="quantity-btn bg-red-500 text-white px-3 py-1 rounded-full text-sm hover:bg-red-600"> Adicionar </button>
          </div>
         </div>
         <div class="menu-item flex justify-between items-center p-3 rounded-lg border border-red-200">
          <div>
           <h4 class="font-medium text-gray-800">Pepperoni</h4>
           <p class="text-sm text-gray-600">Molho de tomate, mussarela e pepperoni</p>
          </div>
          <div class="flex items-center space-x-2"><span class="font-bold text-red-700">R$ 85</span> <button onclick="addToCart('Pizza Pepperoni', 'Pizzas', 85)" class="quantity-btn bg-red-500 text-white px-3 py-1 rounded-full text-sm hover:bg-red-600"> Adicionar </button>
          </div>
         </div>
         <div class="menu-item flex justify-between items-center p-3 rounded-lg border border-red-200">
          <div>
           <h4 class="font-medium text-gray-800">Quatro Queijos</h4>
           <p class="text-sm text-gray-600">Mussarela, gorgonzola, parmes√£o e provolone</p>
          </div>
          <div class="flex items-center space-x-2"><span class="font-bold text-red-700">R$ 90</span> <button onclick="addToCart('Pizza Quatro Queijos', 'Pizzas', 90)" class="quantity-btn bg-red-500 text-white px-3 py-1 rounded-full text-sm hover:bg-red-600"> Adicionar </button>
          </div>
         </div>
        </div>
       </div><!-- Sobremesas -->
       <div class="category-card bg-gradient-to-r from-purple-50 to-pink-50 rounded-lg p-6 mb-6 border-l-4 border-purple-500">
        <h3 class="text-xl font-semibold text-gray-800 mb-4 flex items-center"><span class="bg-purple-500 text-white rounded-full w-8 h-8 flex items-center justify-center text-sm mr-3">üç∞</span> Sobremesas</h3>
        <div class="space-y-3">
         <div class="menu-item flex justify-between items-center p-3 rounded-lg border border-purple-200">
          <div>
           <h4 class="font-medium text-gray-800">Tiramisu</h4>
           <p class="text-sm text-gray-600">Cl√°ssico italiano com caf√© e mascarpone</p>
          </div>
          <div class="flex items-center space-x-2"><span class="font-bold text-purple-700">R$ 35</span> <button onclick="addToCart('Tiramisu', 'Sobremesas', 35)" class="quantity-btn bg-purple-500 text-white px-3 py-1 rounded-full text-sm hover:bg-purple-600"> Adicionar </button>
          </div>
         </div>
         <div class="menu-item flex justify-between items-center p-3 rounded-lg border border-purple-200">
          <div>
           <h4 class="font-medium text-gray-800">Gelato Artesanal</h4>
           <p class="text-sm text-gray-600">Sabores: baunilha, chocolate ou morango</p>
          </div>
          <div class="flex items-center space-x-2"><span class="font-bold text-purple-700">R$ 30</span> <button onclick="addToCart('Gelato Artesanal', 'Sobremesas', 30)" class="quantity-btn bg-purple-500 text-white px-3 py-1 rounded-full text-sm hover:bg-purple-600"> Adicionar </button>
          </div>
         </div>
        </div>
       </div>
      </div>
     </div><!-- Carrinho -->
     <div class="lg:col-span-1">
      <div class="bg-white rounded-xl shadow-lg p-6 sticky top-4">
       <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center"><span class="bg-orange-500 text-white rounded-full w-8 h-8 flex items-center justify-center text-sm mr-3">üõí</span> Seu Pedido</h3>
       <div id="cart-items" class="space-y-3 mb-4 min-h-[100px]">
        <p class="text-gray-500 text-center py-8">Seu carrinho est√° vazio</p>
       </div><!-- Dados de Entrega -->
       <div class="border-t pt-4 mb-4">
        <h4 class="text-sm font-medium text-gray-700 mb-3">üìç Dados para Entrega *</h4>
        <div class="space-y-3">
         <div><label for="customer-name" class="block text-xs text-gray-600 mb-1">Nome completo</label> <input type="text" id="customer-name" placeholder="Seu nome completo..." class="w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 text-sm">
         </div>
         <div><label for="delivery-address" class="block text-xs text-gray-600 mb-1">Endere√ßo e refer√™ncia</label> <textarea id="delivery-address" placeholder="Rua, n√∫mero, bairro e ponto de refer√™ncia..." class="w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 resize-none text-sm" rows="2"></textarea>
         </div>
         <div><label for="customer-whatsapp" class="block text-xs text-gray-600 mb-1">WhatsApp</label> <input type="tel" id="customer-whatsapp" placeholder="(11) 99999-9999" class="w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 text-sm" oninput="formatWhatsApp(this)">
         </div>
        </div>
       </div><!-- Forma de Pagamento -->
       <div class="mb-4"><label class="block text-sm font-medium text-gray-700 mb-3"> üí≥ Forma de Pagamento * </label>
        <div class="space-y-2"><label class="flex items-center p-3 border border-gray-300 rounded-lg hover:bg-gray-50 cursor-pointer"> <input type="radio" name="payment-method" value="dinheiro" onchange="togglePaymentOptions()" class="text-orange-500 focus:ring-orange-500"> <span class="ml-3 text-sm">üíµ Dinheiro</span> </label> <label class="flex items-center p-3 border border-gray-300 rounded-lg hover:bg-gray-50 cursor-pointer"> <input type="radio" name="payment-method" value="pix" onchange="togglePaymentOptions()" class="text-orange-500 focus:ring-orange-500"> <span class="ml-3 text-sm">üì± PIX</span> </label> <label class="flex items-center p-3 border border-gray-300 rounded-lg hover:bg-gray-50 cursor-pointer"> <input type="radio" name="payment-method" value="cartao" onchange="togglePaymentOptions()" class="text-orange-500 focus:ring-orange-500"> <span class="ml-3 text-sm">üí≥ Cart√£o (D√©bito/Cr√©dito)</span> </label>
        </div>
        <div class="mt-2 p-2 bg-blue-50 border border-blue-200 rounded text-xs text-blue-700">
         üí° <strong>Cart√£o:</strong> Levamos a maquininha na entrega! Aceita d√©bito e cr√©dito.
        </div>
       </div><!-- Op√ß√µes de Troco (s√≥ aparece se dinheiro selecionado) -->
       <div id="change-section" class="mb-4 hidden">
        <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-3"><label class="flex items-center mb-2"> <input type="checkbox" id="needs-change" onchange="toggleChangeAmount()" class="text-orange-500 focus:ring-orange-500"> <span class="ml-2 text-sm font-medium">Preciso de troco</span> </label>
         <div id="change-amount-section" class="hidden"><label for="change-amount" class="block text-xs text-gray-600 mb-1"> Valor que voc√™ tem: </label> <input type="number" id="change-amount" step="0.01" min="0" placeholder="Ex: 100.00" class="w-full p-2 border border-gray-300 rounded text-sm focus:ring-2 focus:ring-orange-500">
         </div>
        </div>
       </div>
       <div class="border-t pt-4">
        <div class="flex justify-between items-center mb-4"><span class="font-bold text-lg">Total:</span> <span id="total-price" class="font-bold text-xl text-orange-600">R$ 0,00</span>
        </div><button id="order-button" onclick="finalizeOrder()" class="w-full bg-gradient-to-r from-orange-500 to-red-500 text-white py-3 px-6 rounded-lg font-semibold text-lg hover:from-orange-600 hover:to-red-600 transition-all duration-200 transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none" disabled> Fazer Pedido </button> <button onclick="clearCart()" class="w-full mt-2 bg-gray-200 text-gray-700 py-2 px-4 rounded-lg hover:bg-gray-300 transition-colors"> Limpar Carrinho </button>
       </div>
      </div>
     </div>
    </div>
   </div><!-- Modal de Login Admin -->
   <div id="admin-login-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden">
    <div class="flex items-center justify-center min-h-full p-4">
     <div class="bg-white rounded-xl shadow-2xl max-w-md w-full">
      <div class="bg-gradient-to-r from-gray-700 to-gray-800 text-white p-6 rounded-t-xl">
       <div class="flex justify-between items-center">
        <h2 class="text-xl font-bold">üîê Acesso Administrativo</h2><button onclick="closeAdminLogin()" class="text-white hover:text-gray-300 text-2xl"> ‚úï </button>
       </div>
       <p class="text-gray-300 text-sm mt-2">Digite a senha para acessar o painel</p>
      </div>
      <div class="p-6">
       <div class="mb-4"><label for="admin-password" class="block text-sm font-medium text-gray-700 mb-2"> Senha de Administrador </label> <input type="password" id="admin-password" placeholder="Digite a senha..." class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-gray-500" onkeypress="if(event.key==='Enter') attemptAdminLogin()">
       </div>
       <div id="login-error" class="hidden mb-4 p-3 bg-red-100 border border-red-300 text-red-700 rounded-lg text-sm">
        ‚ùå Senha incorreta. Tente novamente.
       </div>
       <div class="flex space-x-3"><button onclick="closeAdminLogin()" class="flex-1 bg-gray-300 text-gray-700 py-2 px-4 rounded-lg hover:bg-gray-400 transition-colors"> Cancelar </button> <button onclick="attemptAdminLogin()" class="flex-1 bg-gray-700 text-white py-2 px-4 rounded-lg hover:bg-gray-800 transition-colors"> Entrar </button>
       </div>
       <div class="mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg">
        <p class="text-xs text-blue-700">üí° <strong>Dica:</strong> Esta √°rea √© restrita aos administradores da pizzaria.</p>
       </div>
      </div>
     </div>
    </div>
   </div><!-- Painel Administrativo -->
   <div id="admin-panel" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden">
    <div class="flex items-center justify-center min-h-full p-4">
     <div class="bg-white rounded-xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-hidden">
      <div class="bg-gradient-to-r from-gray-700 to-gray-800 text-white p-6">
       <div class="flex justify-between items-center">
        <h2 class="text-2xl font-bold">üìã Painel Administrativo - Pedidos</h2>
        <div class="flex items-center space-x-3"><span class="text-sm text-gray-300"> üë§ Logado como Admin </span> <button onclick="logoutAdmin()" class="bg-red-600 text-white px-3 py-1 rounded text-sm hover:bg-red-700 transition-colors"> üö™ Sair </button> <button onclick="toggleAdminPanel()" class="text-white hover:text-gray-300 text-2xl"> ‚úï </button>
        </div>
       </div>
       <p class="text-gray-300 mt-2">Gerencie todos os pedidos recebidos</p>
      </div>
      <div class="p-6 overflow-y-auto max-h-[70vh]">
       <div class="flex justify-between items-center mb-6">
        <div class="flex items-center space-x-4">
         <div class="bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm font-medium"><span id="total-orders">0</span> Pedidos Hoje
         </div>
         <div class="bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm font-medium">
          Total: <span id="total-revenue">R$ 0,00</span>
         </div>
         <div class="bg-orange-100 text-orange-800 px-3 py-1 rounded-full text-sm font-medium">
          Pendentes: <span id="pending-orders">0</span>
         </div>
        </div>
        <div class="flex space-x-2"><button onclick="refreshOrders()" class="bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition-colors text-sm"> üîÑ Atualizar </button> <button onclick="clearAllOrders()" class="bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition-colors text-sm"> üóëÔ∏è Limpar Tudo </button>
        </div>
       </div><!-- Abas de navega√ß√£o -->
       <div class="flex border-b border-gray-200 mb-6"><button id="tab-pending" onclick="switchTab('pending')" class="tab-button px-6 py-3 font-medium text-sm border-b-2 border-orange-500 text-orange-600 bg-orange-50"> üïê Pedidos Pendentes (<span id="tab-pending-count">0</span>) </button> <button id="tab-completed" onclick="switchTab('completed')" class="tab-button px-6 py-3 font-medium text-sm border-b-2 border-transparent text-gray-500 hover:text-gray-700"> ‚úÖ Hist√≥rico Completo (<span id="tab-completed-count">0</span>) </button>
       </div>
       <div id="orders-list" class="space-y-4">
        <div class="text-center py-12 text-gray-500">
         <div class="text-6xl mb-4">
          üìù
         </div>
         <p class="text-lg">Nenhum pedido recebido ainda</p>
         <p class="text-sm">Os pedidos aparecer√£o aqui em tempo real</p>
        </div>
       </div>
      </div>
     </div>
    </div>
   </div><!-- Modal PIX -->
   <div id="pix-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden">
    <div class="flex items-center justify-center min-h-full p-4">
     <div class="bg-white rounded-xl shadow-2xl max-w-md w-full">
      <div class="bg-gradient-to-r from-green-600 to-green-700 text-white p-6 rounded-t-xl">
       <div class="flex justify-between items-center">
        <h2 class="text-xl font-bold">üì± Pagamento PIX</h2><button onclick="closePixModal()" class="text-white hover:text-gray-300 text-2xl"> ‚úï </button>
       </div>
       <p class="text-green-100 text-sm mt-2">Escaneie o QR Code ou copie a chave</p>
      </div>
      <div class="p-6">
       <div class="text-center mb-6">
        <div class="text-2xl font-bold text-gray-800 mb-2">
         Valor: <span id="pix-amount" class="text-green-600">R$ 0,00</span>
        </div>
       </div><!-- QR Code -->
       <div class="bg-white border-2 border-gray-300 rounded-lg p-4 mb-4">
        <div id="qr-code" class="w-48 h-48 mx-auto bg-white border border-gray-200 rounded"><!-- QR Code ser√° gerado aqui -->
        </div>
       </div><!-- Chave PIX -->
       <div class="mb-6"><label class="block text-sm font-medium text-gray-700 mb-2"> Ou copie a chave PIX: </label>
        <div class="flex"><input type="text" id="pix-key" readonly class="flex-1 p-3 border border-gray-300 rounded-l-lg bg-gray-50 text-xs font-mono"> <button onclick="copyPixKey()" class="bg-green-600 text-white px-4 py-3 rounded-r-lg hover:bg-green-700 transition-colors"> üìã Copiar </button>
        </div>
       </div>
       <div class="flex space-x-3"><button onclick="closePixModal()" class="flex-1 bg-gray-300 text-gray-700 py-3 px-4 rounded-lg hover:bg-gray-400 transition-colors"> Cancelar </button> <button onclick="confirmPixPayment()" class="flex-1 bg-green-600 text-white py-3 px-4 rounded-lg hover:bg-green-700 transition-colors"> ‚úÖ Confirmar Pagamento </button>
       </div>
       <div class="mt-4 p-3 bg-green-50 border border-green-200 rounded-lg">
        <p class="text-xs text-green-700">üí° Ap√≥s realizar o pagamento, clique em "Confirmar Pagamento" para finalizar seu pedido.</p>
       </div>
      </div>
     </div>
    </div>
   </div>
  </div>
  <script>
        // üîí SISTEMA BLOQUEADO PARA EDI√á√ÉO - APENAS ADMIN TEM ACESSO
        
        // ‚≠ê CONFIGURA√á√ÉO DO PIX - DADOS FIXOS DA PIZZARIA RODRIGUES ‚≠ê
        const PIZZARIA_CONFIG = {
            // üî• DADOS DO PIX (FIXOS - N√ÉO EDIT√ÅVEIS PELOS CLIENTES):
            pix_key: "86999049131",                     // ‚Üê CHAVE PIX
            pix_receiver_name: "Ana M√°rcia Silva Rodrigues", // ‚Üê NOME DO RECEBEDOR  
            pix_city: "Cocal dos Alves, PI",            // ‚Üê CIDADE
            
            // Configura√ß√µes de seguran√ßa
            admin_password: 'admin123',
            session_duration: 30 * 60 * 1000, // 30 minutos
            
            // Link personalizado
            custom_link: 'PizzariaRodriguespedidodigital'
        };

        // Estado do sistema
        let cart = [];
        let orderCount = 0;
        let currentTab = 'pending';
        let allOrders = [];
        let adminSessionExpiry = null;

        // üîí BLOQUEAR QUALQUER TENTATIVA DE EDI√á√ÉO
        function blockEditing() {
            // Remover controles de edi√ß√£o do Canva
            const editElements = document.querySelectorAll('.canva-edit-controls, .canva-edit-panel, [data-canva-editable]');
            editElements.forEach(el => {
                el.style.display = 'none';
                el.style.visibility = 'hidden';
            });
            
            // Bloquear context menu
            document.addEventListener('contextmenu', function(e) {
                e.preventDefault();
                return false;
            });
            
            // Bloquear teclas de desenvolvedor
            document.addEventListener('keydown', function(e) {
                if (e.key === 'F12' || 
                    (e.ctrlKey && e.shiftKey && e.key === 'I') ||
                    (e.ctrlKey && e.shiftKey && e.key === 'C') ||
                    (e.ctrlKey && e.key === 'U')) {
                    e.preventDefault();
                    return false;
                }
            });
        }

        // Inicializa√ß√£o
        async function initializeApp() {
            // Bloquear edi√ß√£o
            blockEditing();
            
            // Verificar sess√£o admin ao carregar
            checkAdminSession();
            
            // Carregar pedidos existentes
            allOrders = JSON.parse(localStorage.getItem('pizzaria_orders') || '[]');
            
            // Mostrar informa√ß√µes do link personalizado
            console.log(`üîó Link Personalizado: ${PIZZARIA_CONFIG.custom_link}`);
        }

        // Fun√ß√µes de autentica√ß√£o admin
        function requestAdminAccess() {
            if (isAdminLoggedIn()) {
                toggleAdminPanel();
            } else {
                showAdminLogin();
            }
        }

        function showAdminLogin() {
            const modal = document.getElementById('admin-login-modal');
            const passwordInput = document.getElementById('admin-password');
            const errorDiv = document.getElementById('login-error');
            
            modal.classList.remove('hidden');
            errorDiv.classList.add('hidden');
            passwordInput.value = '';
            passwordInput.focus();
        }

        function closeAdminLogin() {
            const modal = document.getElementById('admin-login-modal');
            modal.classList.add('hidden');
        }

        function attemptAdminLogin() {
            const passwordInput = document.getElementById('admin-password');
            const errorDiv = document.getElementById('login-error');
            const password = passwordInput.value;

            if (password === PIZZARIA_CONFIG.admin_password) {
                // Login bem-sucedido
                adminSessionExpiry = Date.now() + PIZZARIA_CONFIG.session_duration;
                localStorage.setItem('adminSessionExpiry', adminSessionExpiry.toString());
                
                closeAdminLogin();
                toggleAdminPanel();
                showToast('Login realizado com sucesso! üéâ', 'success');
            } else {
                // Senha incorreta
                errorDiv.classList.remove('hidden');
                passwordInput.classList.add('shake');
                passwordInput.value = '';
                passwordInput.focus();
                
                // Remover anima√ß√£o ap√≥s completar
                setTimeout(() => {
                    passwordInput.classList.remove('shake');
                }, 500);
            }
        }

        function isAdminLoggedIn() {
            const storedExpiry = localStorage.getItem('adminSessionExpiry');
            if (!storedExpiry) return false;
            
            const expiry = parseInt(storedExpiry);
            if (Date.now() > expiry) {
                // Sess√£o expirada
                localStorage.removeItem('adminSessionExpiry');
                adminSessionExpiry = null;
                return false;
            }
            
            adminSessionExpiry = expiry;
            return true;
        }

        function checkAdminSession() {
            if (adminSessionExpiry && Date.now() > adminSessionExpiry) {
                logoutAdmin();
                showToast('Sess√£o administrativa expirada. Fa√ßa login novamente.', 'error');
            }
        }

        function logoutAdmin() {
            adminSessionExpiry = null;
            localStorage.removeItem('adminSessionExpiry');
            
            // Fechar painel se estiver aberto
            const panel = document.getElementById('admin-panel');
            if (!panel.classList.contains('hidden')) {
                panel.classList.add('hidden');
            }
            
            showToast('Logout realizado com sucesso! üëã', 'success');
        }

        // Verificar sess√£o periodicamente
        setInterval(checkAdminSession, 60000); // Verificar a cada minuto

        // Adicionar item ao carrinho
        function addToCart(name, category, price) {
            const existingItem = cart.find(item => item.name === name);
            
            if (existingItem) {
                existingItem.quantity += 1;
            } else {
                cart.push({
                    id: Date.now().toString(),
                    name: name,
                    category: category,
                    price: price,
                    quantity: 1
                });
            }
            
            updateCartDisplay();
            showToast(`${name} adicionado ao carrinho!`);
        }

        // Remover item do carrinho
        function removeFromCart(itemId) {
            cart = cart.filter(item => item.id !== itemId);
            updateCartDisplay();
        }

        // Atualizar quantidade
        function updateQuantity(itemId, change) {
            const item = cart.find(item => item.id === itemId);
            if (item) {
                item.quantity += change;
                if (item.quantity <= 0) {
                    removeFromCart(itemId);
                } else {
                    updateCartDisplay();
                }
            }
        }

        // Atualizar exibi√ß√£o do carrinho
        function updateCartDisplay() {
            const cartItemsElement = document.getElementById('cart-items');
            const totalPriceElement = document.getElementById('total-price');
            const orderButton = document.getElementById('order-button');
            
            if (cart.length === 0) {
                cartItemsElement.innerHTML = '<p class="text-gray-500 text-center py-8">Seu carrinho est√° vazio</p>';
                totalPriceElement.textContent = 'R$ 0,00';
                orderButton.disabled = true;
                return;
            }
            
            // Verificar se todos os campos obrigat√≥rios est√£o preenchidos
            const customerName = document.getElementById('customer-name').value.trim();
            const deliveryAddress = document.getElementById('delivery-address').value.trim();
            const customerWhatsapp = document.getElementById('customer-whatsapp').value.trim();
            const paymentMethod = document.querySelector('input[name="payment-method"]:checked');
            
            orderButton.disabled = !customerName || !deliveryAddress || !customerWhatsapp || !paymentMethod;
            
            let total = 0;
            cartItemsElement.innerHTML = cart.map(item => {
                const itemTotal = item.price * item.quantity;
                total += itemTotal;
                
                return `
                    <div class="cart-item bg-gray-50 p-3 rounded-lg border">
                        <div class="flex justify-between items-start mb-2">
                            <h4 class="font-medium text-sm">${item.name}</h4>
                            <button onclick="removeFromCart('${item.id}')" 
                                    class="text-red-500 hover:text-red-700 text-xs">
                                ‚úï
                            </button>
                        </div>
                        <div class="flex justify-between items-center">
                            <div class="flex items-center space-x-2">
                                <button onclick="updateQuantity('${item.id}', -1)" 
                                        class="quantity-btn bg-gray-300 text-gray-700 w-6 h-6 rounded-full text-xs hover:bg-gray-400">
                                    -
                                </button>
                                <span class="text-sm font-medium">${item.quantity}</span>
                                <button onclick="updateQuantity('${item.id}', 1)" 
                                        class="quantity-btn bg-orange-500 text-white w-6 h-6 rounded-full text-xs hover:bg-orange-600">
                                    +
                                </button>
                            </div>
                            <span class="font-bold text-sm">R$ ${itemTotal.toFixed(2).replace('.', ',')}</span>
                        </div>
                    </div>
                `;
            }).join('');
            
            totalPriceElement.textContent = `R$ ${total.toFixed(2).replace('.', ',')}`;
        }

        // Limpar carrinho
        function clearCart() {
            cart = [];
            updateCartDisplay();
            showToast('Carrinho limpo!');
        }

        // Finalizar pedido
        async function finalizeOrder() {
            if (cart.length === 0) return;
            
            // Validar campos obrigat√≥rios
            const customerName = document.getElementById('customer-name').value.trim();
            const deliveryAddress = document.getElementById('delivery-address').value.trim();
            const customerWhatsapp = document.getElementById('customer-whatsapp').value.trim();
            const paymentMethod = document.querySelector('input[name="payment-method"]:checked');
            
            if (!customerName) {
                showToast('Por favor, preencha seu nome completo', 'error');
                return;
            }
            
            if (!deliveryAddress) {
                showToast('Por favor, preencha o endere√ßo de entrega', 'error');
                return;
            }
            
            if (!customerWhatsapp) {
                showToast('Por favor, preencha seu WhatsApp', 'error');
                return;
            }
            
            if (!paymentMethod) {
                showToast('Por favor, selecione a forma de pagamento', 'error');
                return;
            }
            
            // Se for PIX, mostrar modal do QR Code
            if (paymentMethod.value === 'pix') {
                showPixModal();
                return;
            }
            
            // Se for dinheiro ou cart√£o, processar diretamente
            await processOrder();
        }
        
        // Processar pedido (comum para dinheiro e PIX ap√≥s confirma√ß√£o)
        async function processOrder() {
            const orderButton = document.getElementById('order-button');
            const originalText = orderButton.textContent;
            
            // Mostrar loading
            orderButton.disabled = true;
            orderButton.textContent = 'Processando...';
            
            try {
                // Coletar dados do pedido
                const customerName = document.getElementById('customer-name').value.trim();
                const deliveryAddress = document.getElementById('delivery-address').value.trim();
                const customerWhatsapp = document.getElementById('customer-whatsapp').value.trim();
                const paymentMethod = document.querySelector('input[name="payment-method"]:checked').value;
                const needsChange = document.getElementById('needs-change').checked;
                const changeAmount = parseFloat(document.getElementById('change-amount').value) || 0;
                
                // Calcular troco se necess√°rio
                const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
                const changeDue = needsChange && changeAmount > total ? changeAmount - total : 0;
                
                // Salvar pedido localmente
                const orderId = `order_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
                
                const orderData = {
                    id: orderId,
                    items: cart.map(item => ({
                        name: item.name,
                        category: item.category,
                        price: item.price,
                        quantity: item.quantity
                    })),
                    customer_name: customerName,
                    delivery_address: deliveryAddress,
                    customer_whatsapp: customerWhatsapp,
                    payment_method: paymentMethod,
                    needs_change: needsChange,
                    change_amount: changeAmount,
                    change_due: changeDue,
                    timestamp: new Date().toISOString(),
                    status: 'pending',
                    total: total
                };
                
                // Salvar no localStorage
                const existingOrders = JSON.parse(localStorage.getItem('pizzaria_orders') || '[]');
                existingOrders.push(orderData);
                localStorage.setItem('pizzaria_orders', JSON.stringify(existingOrders));
                
                // Atualizar painel admin se estiver aberto
                allOrders = existingOrders;
                updateAdminPanel(allOrders);
                
                // Mostrar popup de confirma√ß√£o
                showOrderConfirmationModal(customerName, orderId, total);
                
                // Limpar formul√°rio
                cart = [];
                document.getElementById('customer-name').value = '';
                document.getElementById('delivery-address').value = '';
                document.getElementById('customer-whatsapp').value = '';
                document.querySelectorAll('input[name="payment-method"]').forEach(radio => radio.checked = false);
                document.getElementById('needs-change').checked = false;
                document.getElementById('change-amount').value = '';
                togglePaymentOptions();
                updateCartDisplay();
                
            } catch (error) {
                showToast('Erro ao processar pedido. Tente novamente.', 'error');
            } finally {
                orderButton.disabled = false;
                orderButton.textContent = originalText;
            }
        }

        // Fun√ß√£o para mostrar popup de confirma√ß√£o do pedido
        function showOrderConfirmationModal(customerName, orderId, total) {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4';
            modal.innerHTML = `
                <div class="bg-white rounded-xl shadow-2xl max-w-md w-full animate-bounce-in">
                    <div class="bg-gradient-to-r from-green-500 to-green-600 text-white p-6 rounded-t-xl text-center">
                        <div class="text-6xl mb-4">üéâ</div>
                        <h2 class="text-2xl font-bold">Pedido Confirmado!</h2>
                        <p class="text-green-100 text-sm mt-2">Seu pedido foi recebido com sucesso</p>
                    </div>
                    
                    <div class="p-6 text-center">
                        <div class="mb-6">
                            <h3 class="text-xl font-bold text-gray-800 mb-2">Ol√°, ${customerName}! üëã</h3>
                            <div class="bg-gray-50 rounded-lg p-4 mb-4">
                                <p class="text-sm text-gray-600 mb-2">üìã <strong>N√∫mero do Pedido:</strong></p>
                                <p class="text-lg font-bold text-orange-600">#${orderId.split('_')[1].slice(-6)}</p>
                            </div>
                            <div class="bg-green-50 rounded-lg p-4 mb-4">
                                <p class="text-sm text-gray-600 mb-2">üí∞ <strong>Valor Total:</strong></p>
                                <p class="text-2xl font-bold text-green-600">R$ ${total.toFixed(2).replace('.', ',')}</p>
                            </div>
                        </div>
                        
                        <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6">
                            <div class="text-blue-600 text-4xl mb-2">üöö</div>
                            <p class="text-blue-800 font-medium">Tempo estimado de entrega:</p>
                            <p class="text-blue-600 text-lg font-bold">30 - 45 minutos</p>
                            <p class="text-blue-600 text-sm mt-2">Em breve nosso entregador estar√° a caminho!</p>
                        </div>
                        
                        <button onclick="closeConfirmationModal()" 
                                class="w-full bg-gradient-to-r from-green-500 to-green-600 text-white py-3 px-6 rounded-lg font-semibold text-lg hover:from-green-600 hover:to-green-700 transition-all duration-200 transform hover:scale-105">
                            ‚úÖ Entendi, Obrigado!
                        </button>
                        
                        <div class="mt-4 p-3 bg-orange-50 border border-orange-200 rounded-lg">
                            <p class="text-xs text-orange-700">
                                üçï <strong>Pizzaria Rodrigues</strong> - Obrigado por escolher nosso sabor aut√™ntico!
                            </p>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
        }
        
        // Fun√ß√£o para fechar modal de confirma√ß√£o
        function closeConfirmationModal() {
            const modal = document.querySelector('.fixed.z-50');
            if (modal) {
                modal.remove();
            }
        }

        // Mostrar toast
        function showToast(message, type = 'info') {
            const toast = document.createElement('div');
            const bgColor = type === 'success' ? 'bg-green-500' : type === 'error' ? 'bg-red-500' : 'bg-orange-500';
            
            toast.className = `toast ${bgColor} text-white px-4 py-2 rounded-lg shadow-lg`;
            toast.textContent = message;
            
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.remove();
            }, 3000);
        }

        // Fun√ß√µes do painel administrativo
        function toggleAdminPanel() {
            if (!isAdminLoggedIn()) {
                showAdminLogin();
                return;
            }
            
            const panel = document.getElementById('admin-panel');
            if (panel.classList.contains('hidden')) {
                panel.classList.remove('hidden');
                refreshOrders();
            } else {
                panel.classList.add('hidden');
            }
        }

        function switchTab(tab) {
            currentTab = tab;
            
            // Atualizar apar√™ncia das abas
            const pendingTab = document.getElementById('tab-pending');
            const completedTab = document.getElementById('tab-completed');
            
            if (tab === 'pending') {
                pendingTab.className = 'tab-button px-6 py-3 font-medium text-sm border-b-2 border-orange-500 text-orange-600 bg-orange-50';
                completedTab.className = 'tab-button px-6 py-3 font-medium text-sm border-b-2 border-transparent text-gray-500 hover:text-gray-700';
            } else {
                pendingTab.className = 'tab-button px-6 py-3 font-medium text-sm border-b-2 border-transparent text-gray-500 hover:text-gray-700';
                completedTab.className = 'tab-button px-6 py-3 font-medium text-sm border-b-2 border-green-500 text-green-600 bg-green-50';
            }
            
            // Atualizar lista de pedidos
            updateAdminPanel(allOrders);
        }

        async function refreshOrders() {
            // Carregar pedidos do localStorage
            allOrders = JSON.parse(localStorage.getItem('pizzaria_orders') || '[]');
            updateAdminPanel(allOrders);
        }

        function updateAdminPanel(orders) {
            const ordersList = document.getElementById('orders-list');
            const totalOrdersElement = document.getElementById('total-orders');
            const totalRevenueElement = document.getElementById('total-revenue');
            const pendingOrdersElement = document.getElementById('pending-orders');
            const tabPendingCount = document.getElementById('tab-pending-count');
            const tabCompletedCount = document.getElementById('tab-completed-count');
            
            if (!orders || orders.length === 0) {
                ordersList.innerHTML = `
                    <div class="text-center py-12 text-gray-500">
                        <div class="text-6xl mb-4">üìù</div>
                        <p class="text-lg">Nenhum pedido recebido ainda</p>
                        <p class="text-sm">Os pedidos aparecer√£o aqui em tempo real</p>
                    </div>
                `;
                totalOrdersElement.textContent = '0';
                totalRevenueElement.textContent = 'R$ 0,00';
                pendingOrdersElement.textContent = '0';
                tabPendingCount.textContent = '0';
                tabCompletedCount.textContent = '0';
                return;
            }

            // Filtrar pedidos por status
            const pendingOrders = orders.filter(order => order.status === 'pending');
            const completedOrders = orders.filter(order => order.status === 'completed');
            
            // Escolher quais pedidos mostrar baseado na aba atual
            const ordersToShow = currentTab === 'pending' ? pendingOrders : completedOrders;

            // Calcular totais
            const totalRevenue = orders.reduce((sum, order) => sum + order.total, 0);
            
            // Atualizar contadores
            totalOrdersElement.textContent = orders.length;
            totalRevenueElement.textContent = `R$ ${totalRevenue.toFixed(2).replace('.', ',')}`;
            pendingOrdersElement.textContent = pendingOrders.length;
            tabPendingCount.textContent = pendingOrders.length;
            tabCompletedCount.textContent = completedOrders.length;

            // Verificar se h√° pedidos para mostrar na aba atual
            if (ordersToShow.length === 0) {
                const emptyMessage = currentTab === 'pending' 
                    ? { icon: 'üïê', title: 'Nenhum pedido pendente', subtitle: 'Todos os pedidos foram conclu√≠dos!' }
                    : { icon: '‚úÖ', title: 'Nenhum pedido no hist√≥rico', subtitle: 'Pedidos conclu√≠dos aparecer√£o aqui' };
                    
                ordersList.innerHTML = `
                    <div class="text-center py-12 text-gray-500">
                        <div class="text-6xl mb-4">${emptyMessage.icon}</div>
                        <p class="text-lg">${emptyMessage.title}</p>
                        <p class="text-sm">${emptyMessage.subtitle}</p>
                    </div>
                `;
                return;
            }

            // Renderizar pedidos
            ordersList.innerHTML = ordersToShow
                .sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp)) // Mais recentes primeiro
                .map(order => {
                    const orderTime = new Date(order.timestamp).toLocaleString('pt-BR');
                    const orderId = order.id.split('_')[1]; // Extrair ID do pedido
                    const isCompleted = order.status === 'completed';
                    
                    return `
                        <div class="bg-white border border-gray-200 rounded-lg p-4 shadow-sm">
                            <div class="flex justify-between items-start mb-3">
                                <div>
                                    <h3 class="font-bold text-lg text-gray-800">Pedido #${orderId.slice(-6)}</h3>
                                    <p class="text-sm text-gray-600">üìÖ ${orderTime}</p>
                                </div>
                                <div class="text-right">
                                    <div class="bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm font-bold">
                                        R$ ${order.total.toFixed(2).replace('.', ',')}
                                    </div>
                                </div>
                            </div>
                            
                            <div class="space-y-2">
                                ${order.items.map(item => `
                                    <div class="flex justify-between items-center py-2 border-b border-gray-100 last:border-b-0">
                                        <div class="flex-1">
                                            <span class="font-medium">${item.name}</span>
                                            <span class="text-sm text-gray-500 ml-2">(${item.category})</span>
                                        </div>
                                        <div class="text-right">
                                            <span class="text-sm text-gray-600">${item.quantity}x R$ ${item.price.toFixed(2).replace('.', ',')}</span>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                            
                            <!-- Informa√ß√µes de Entrega e Pagamento -->
                            <div class="mt-4 p-3 bg-gray-50 rounded-lg">
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-3 text-sm">
                                    <div>
                                        <span class="font-medium text-gray-700">üë§ Cliente:</span>
                                        <p class="text-gray-600 mt-1">${order.customer_name || 'N√£o informado'}</p>
                                        <span class="font-medium text-gray-700">üì± WhatsApp:</span>
                                        <p class="text-gray-600 mt-1">${order.customer_whatsapp || 'N√£o informado'}</p>
                                    </div>
                                    <div>
                                        <span class="font-medium text-gray-700">üìç Endere√ßo:</span>
                                        <p class="text-gray-600 mt-1">${order.delivery_address || 'N√£o informado'}</p>
                                    </div>
                                </div>
                                <div class="mt-3 pt-3 border-t border-gray-200">
                                    <span class="font-medium text-gray-700">üí≥ Pagamento:</span>
                                    <p class="text-gray-600 mt-1">
                                        ${order.payment_method === 'pix' ? 'üì± PIX' : 
                                          order.payment_method === 'cartao' ? 'üí≥ Cart√£o (D√©bito/Cr√©dito)' : 'üíµ Dinheiro'}
                                        ${order.payment_method === 'dinheiro' && order.needs_change ? 
                                            `<br><span class="text-xs text-orange-600">Troco para R$ ${order.change_amount?.toFixed(2).replace('.', ',')} = R$ ${order.change_due?.toFixed(2).replace('.', ',')}</span>` 
                                            : ''}
                                        ${order.payment_method === 'cartao' ? 
                                            `<br><span class="text-xs text-blue-600">üè™ Maquininha ser√° levada na entrega</span>` 
                                            : ''}
                                    </p>
                                </div>
                            </div>
                            
                            <div class="mt-3 pt-3 border-t border-gray-200 flex justify-between items-center">
                                <div class="flex space-x-2">
                                    ${isCompleted 
                                        ? '<span class="bg-green-100 text-green-800 px-2 py-1 rounded text-xs">‚úÖ Conclu√≠do</span>'
                                        : '<span class="bg-yellow-100 text-yellow-800 px-2 py-1 rounded text-xs">üïê Pendente</span>'
                                    }
                                </div>
                                ${!isCompleted 
                                    ? `<button onclick="markOrderComplete('${orderId}')" 
                                              class="bg-green-500 text-white px-3 py-1 rounded text-sm hover:bg-green-600 transition-colors">
                                          ‚úÖ Concluir
                                      </button>`
                                    : '<span class="text-sm text-gray-500">Pedido finalizado</span>'
                                }
                            </div>
                        </div>
                    `;
                }).join('');
        }

        async function clearAllOrders() {
            // Confirmar a√ß√£o
            const confirmDiv = document.createElement('div');
            confirmDiv.className = 'fixed inset-0 bg-black bg-opacity-50 z-[60] flex items-center justify-center';
            confirmDiv.innerHTML = `
                <div class="bg-white rounded-lg p-6 max-w-md mx-4">
                    <h3 class="text-lg font-bold mb-4">‚ö†Ô∏è Confirmar Exclus√£o</h3>
                    <p class="text-gray-600 mb-6">Tem certeza que deseja excluir TODOS os pedidos? Esta a√ß√£o n√£o pode ser desfeita.</p>
                    <div class="flex space-x-3">
                        <button onclick="this.closest('.fixed').remove()" 
                                class="flex-1 bg-gray-300 text-gray-700 py-2 px-4 rounded hover:bg-gray-400">
                            Cancelar
                        </button>
                        <button onclick="confirmClearOrders()" 
                                class="flex-1 bg-red-500 text-white py-2 px-4 rounded hover:bg-red-600">
                            Excluir Tudo
                        </button>
                    </div>
                </div>
            `;
            document.body.appendChild(confirmDiv);
        }

        async function confirmClearOrders() {
            // Fechar modal de confirma√ß√£o
            document.querySelector('.fixed.z-\\[60\\]').remove();
            
            // Limpar localStorage
            localStorage.removeItem('pizzaria_orders');
            allOrders = [];
            
            showToast('Todos os pedidos foram removidos', 'success');
            
            // Atualizar interface
            updateAdminPanel([]);
            orderCount = 0;
        }

        async function markOrderComplete(orderId) {
            try {
                // Encontrar e atualizar o pedido no localStorage
                const orders = JSON.parse(localStorage.getItem('pizzaria_orders') || '[]');
                const orderIndex = orders.findIndex(order => order.id.includes(orderId));
                
                if (orderIndex !== -1) {
                    orders[orderIndex].status = 'completed';
                    localStorage.setItem('pizzaria_orders', JSON.stringify(orders));
                    
                    // Atualizar dados locais
                    allOrders = orders;
                    updateAdminPanel(allOrders);
                    
                    showToast('Pedido marcado como conclu√≠do! üéâ', 'success');
                }
                
            } catch (error) {
                showToast('Erro ao concluir pedido. Tente novamente.', 'error');
            }
        }

        // Fun√ß√µes de controle de pagamento
        function togglePaymentOptions() {
            const paymentMethod = document.querySelector('input[name="payment-method"]:checked');
            const changeSection = document.getElementById('change-section');
            
            if (paymentMethod && paymentMethod.value === 'dinheiro') {
                changeSection.classList.remove('hidden');
            } else {
                changeSection.classList.add('hidden');
                document.getElementById('needs-change').checked = false;
                toggleChangeAmount();
            }
            
            // Atualizar estado do bot√£o
            updateCartDisplay();
        }
        
        function toggleChangeAmount() {
            const needsChange = document.getElementById('needs-change').checked;
            const changeAmountSection = document.getElementById('change-amount-section');
            
            if (needsChange) {
                changeAmountSection.classList.remove('hidden');
            } else {
                changeAmountSection.classList.add('hidden');
                document.getElementById('change-amount').value = '';
            }
        }
        
        // Fun√ß√µes do PIX
        function showPixModal() {
            const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const pixModal = document.getElementById('pix-modal');
            const pixAmount = document.getElementById('pix-amount');
            
            // Atualizar valor
            pixAmount.textContent = `R$ ${total.toFixed(2).replace('.', ',')}`;
            
            // Gerar QR Code e chave PIX
            generatePixQRCode(total);
            
            // Mostrar modal
            pixModal.classList.remove('hidden');
        }
        
        function closePixModal() {
            const pixModal = document.getElementById('pix-modal');
            pixModal.classList.add('hidden');
        }
        
        function generatePixQRCode(amount) {
            const qrCodeContainer = document.getElementById('qr-code');
            const pixKeyInput = document.getElementById('pix-key');
            
            // Usar dados fixos da pizzaria
            const pixData = {
                chavePix: PIZZARIA_CONFIG.pix_key,
                valor: amount.toFixed(2),
                nomeRecebedor: PIZZARIA_CONFIG.pix_receiver_name,
                cidade: PIZZARIA_CONFIG.pix_city
            };
            
            // Gerar string PIX no formato EMV padr√£o do Banco Central
            const pixString = generatePixEMVString(pixData);
            
            // Definir chave PIX para c√≥pia
            pixKeyInput.value = pixData.chavePix;
            
            // Gerar QR Code real usando API externa
            generateRealQRCode(pixString, qrCodeContainer);
        }
        
        function generatePixEMVString(pixData) {
            // Fun√ß√£o para formatar campo EMV
            function formatEMVField(id, value) {
                const length = value.length.toString().padStart(2, '0');
                return id + length + value;
            }
            
            // Fun√ß√£o para calcular CRC16
            function calculateCRC16(data) {
                let crc = 0xFFFF;
                for (let i = 0; i < data.length; i++) {
                    crc ^= data.charCodeAt(i) << 8;
                    for (let j = 0; j < 8; j++) {
                        if (crc & 0x8000) {
                            crc = (crc << 1) ^ 0x1021;
                        } else {
                            crc = crc << 1;
                        }
                        crc &= 0xFFFF;
                    }
                }
                return crc.toString(16).toUpperCase().padStart(4, '0');
            }
            
            // Construir string PIX EMV
            let emvString = '';
            
            // Payload Format Indicator
            emvString += formatEMVField('00', '01');
            
            // Point of Initiation Method (opcional)
            emvString += formatEMVField('01', '12');
            
            // Merchant Account Information
            const pixKey = pixData.chavePix;
            const merchantInfo = formatEMVField('00', 'BR.GOV.BCB.PIX') + formatEMVField('01', pixKey);
            emvString += formatEMVField('26', merchantInfo);
            
            // Merchant Category Code
            emvString += formatEMVField('52', '0000');
            
            // Transaction Currency (BRL = 986)
            emvString += formatEMVField('53', '986');
            
            // Transaction Amount
            emvString += formatEMVField('54', pixData.valor);
            
            // Country Code
            emvString += formatEMVField('58', 'BR');
            
            // Merchant Name
            const merchantName = pixData.nomeRecebedor.substring(0, 25); // M√°ximo 25 caracteres
            emvString += formatEMVField('59', merchantName);
            
            // Merchant City
            const merchantCity = pixData.cidade.substring(0, 15); // M√°ximo 15 caracteres
            emvString += formatEMVField('60', merchantCity);
            
            // Additional Data Field Template (opcional)
            const additionalData = formatEMVField('05', '***');
            emvString += formatEMVField('62', additionalData);
            
            // CRC16 (ser√° calculado e adicionado)
            emvString += '6304';
            
            // Calcular e adicionar CRC16
            const crc = calculateCRC16(emvString);
            emvString = emvString.substring(0, emvString.length - 4) + '63' + '04' + crc;
            
            return emvString;
        }
        
        function generateRealQRCode(pixString, container) {
            // Usar API do QR Server para gerar QR Code real
            const qrCodeUrl = `https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(pixString)}&format=png&margin=10`;
            
            container.innerHTML = `
                <div class="flex items-center justify-center w-full h-full">
                    <img src="${qrCodeUrl}" 
                         alt="QR Code PIX" 
                         class="max-w-full max-h-full object-contain rounded border"
                         onerror="this.style.display='none'; this.nextElementSibling.style.display='block';"
                         onload="this.nextElementSibling.style.display='none';">
                    <div class="text-center text-gray-500 text-sm" style="display: none;">
                        <div class="text-4xl mb-2">üì±</div>
                        <p>QR Code PIX</p>
                        <p class="text-xs mt-1">Use a chave PIX abaixo</p>
                    </div>
                </div>
            `;
        }
        
        function copyPixKey() {
            const pixKeyInput = document.getElementById('pix-key');
            pixKeyInput.select();
            pixKeyInput.setSelectionRange(0, 99999); // Para dispositivos m√≥veis
            
            try {
                document.execCommand('copy');
                showToast('Chave PIX copiada! üìã', 'success');
            } catch (err) {
                showToast('Erro ao copiar. Selecione e copie manualmente.', 'error');
            }
        }
        
        async function confirmPixPayment() {
            closePixModal();
            await processOrder();
        }
        
        // Fun√ß√£o para formatar WhatsApp
        function formatWhatsApp(input) {
            let value = input.value.replace(/\D/g, ''); // Remove tudo que n√£o √© d√≠gito
            
            if (value.length <= 11) {
                // Formato: (11) 99999-9999
                value = value.replace(/^(\d{2})(\d{5})(\d{4})$/, '($1) $2-$3');
                value = value.replace(/^(\d{2})(\d{4})$/, '($1) $2');
                value = value.replace(/^(\d{2})$/, '($1');
            }
            
            input.value = value;
        }
        
        // üîó FUN√á√ïES DO LINK CLIC√ÅVEL PERSONALIZADO
        
        // Copiar link direto
        function copyDirectLink() {
            const linkInput = document.getElementById('direct-link');
            linkInput.select();
            linkInput.setSelectionRange(0, 99999);
            
            try {
                document.execCommand('copy');
                showToast('Link copiado! üîó Compartilhe com seus clientes', 'success');
            } catch (err) {
                // Fallback para navegadores mais antigos
                fallbackCopyLink(linkInput.value);
            }
        }
        
        // Fallback para copiar link
        function fallbackCopyLink(link) {
            if (navigator.clipboard && window.isSecureContext) {
                navigator.clipboard.writeText(link).then(() => {
                    showToast('Link copiado! üîó Compartilhe com seus clientes', 'success');
                }).catch(() => {
                    showToast('Erro ao copiar. Selecione e copie manualmente.', 'error');
                });
            } else {
                showToast('Link selecionado! Use Ctrl+C para copiar', 'info');
            }
        }
        
        // Compartilhar no WhatsApp
        function shareWhatsApp() {
            const link = document.getElementById('direct-link').value;
            const message = `üçï *Pizzaria Rodrigues* üçï

Fa√ßa seu pedido online de forma r√°pida e f√°cil!

üîó *Link direto para pedidos:*
${link}

‚ú® Clique no link acima e escolha suas pizzas favoritas!

üöö Entregamos na sua casa com todo carinho
‚è∞ Tempo de entrega: 30-45 minutos
üí≥ Aceitamos PIX, dinheiro e cart√£o

Experimente o sabor aut√™ntico da nossa cozinha! üòã`;

            const encodedMessage = encodeURIComponent(message);
            
            // Tentar diferentes m√©todos de compartilhamento
            const whatsappUrls = [
                `whatsapp://send?text=${encodedMessage}`,
                `https://wa.me/?text=${encodedMessage}`,
                `https://web.whatsapp.com/send?text=${encodedMessage}`
            ];
            
            // Tentar abrir WhatsApp app primeiro
            const link1 = document.createElement('a');
            link1.href = whatsappUrls[0];
            link1.click();
            
            // Fallback para WhatsApp Web ap√≥s 2 segundos
            setTimeout(() => {
                window.open(whatsappUrls[2], '_blank', 'noopener,noreferrer');
            }, 2000);
            
            showToast('Abrindo WhatsApp para compartilhar! üì±', 'success');
        }
        
        // Compartilhamento geral (Web Share API ou fallback)
        function shareGeneral() {
            const link = document.getElementById('direct-link').value;
            const shareData = {
                title: 'üçï Pizzaria Rodrigues - Pedido Online',
                text: 'Fa√ßa seu pedido online na Pizzaria Rodrigues! Pizzas deliciosas entregues na sua casa.',
                url: link
            };
            
            // Verificar se o navegador suporta Web Share API
            if (navigator.share && navigator.canShare && navigator.canShare(shareData)) {
                navigator.share(shareData)
                    .then(() => showToast('Link compartilhado com sucesso! üì§', 'success'))
                    .catch(() => fallbackShare(link));
            } else {
                fallbackShare(link);
            }
        }
        
        // Fallback para compartilhamento
        function fallbackShare(link) {
            // Criar modal com op√ß√µes de compartilhamento
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4';
            modal.innerHTML = `
                <div class="bg-white rounded-xl shadow-2xl max-w-md w-full">
                    <div class="bg-gradient-to-r from-blue-600 to-blue-700 text-white p-6 rounded-t-xl">
                        <div class="flex justify-between items-center">
                            <h2 class="text-xl font-bold">üì§ Compartilhar Link</h2>
                            <button onclick="this.closest('.fixed').remove()" 
                                    class="text-white hover:text-gray-300 text-2xl">
                                ‚úï
                            </button>
                        </div>
                        <p class="text-blue-100 text-sm mt-2">Escolha como compartilhar o link de pedidos</p>
                    </div>
                    
                    <div class="p-6">
                        <div class="mb-4">
                            <label class="block text-sm font-medium text-gray-700 mb-2">Link para copiar:</label>
                            <div class="flex">
                                <input type="text" value="${link}" readonly 
                                       class="flex-1 p-2 bg-gray-50 border border-gray-300 rounded-l text-xs font-mono"
                                       id="share-link-input">
                                <button onclick="copyShareLink()" 
                                        class="bg-blue-500 text-white px-3 py-2 rounded-r hover:bg-blue-600 transition-colors text-xs">
                                    üìã Copiar
                                </button>
                            </div>
                        </div>
                        
                        <div class="space-y-3">
                            <button onclick="shareToFacebook('${link}')" 
                                    class="w-full bg-blue-600 text-white p-3 rounded-lg hover:bg-blue-700 transition-colors text-left">
                                <div class="flex items-center space-x-3">
                                    <span class="text-xl">üìò</span>
                                    <span>Compartilhar no Facebook</span>
                                </div>
                            </button>
                            
                            <button onclick="shareToTwitter('${link}')" 
                                    class="w-full bg-sky-500 text-white p-3 rounded-lg hover:bg-sky-600 transition-colors text-left">
                                <div class="flex items-center space-x-3">
                                    <span class="text-xl">üê¶</span>
                                    <span>Compartilhar no Twitter</span>
                                </div>
                            </button>
                            
                            <button onclick="shareToTelegram('${link}')" 
                                    class="w-full bg-blue-500 text-white p-3 rounded-lg hover:bg-blue-600 transition-colors text-left">
                                <div class="flex items-center space-x-3">
                                    <span class="text-xl">‚úàÔ∏è</span>
                                    <span>Compartilhar no Telegram</span>
                                </div>
                            </button>
                        </div>
                        
                        <div class="mt-6">
                            <button onclick="this.closest('.fixed').remove()" 
                                    class="w-full bg-gray-300 text-gray-700 py-2 px-4 rounded-lg hover:bg-gray-400 transition-colors">
                                Fechar
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
        }
        
        // Copiar link do modal de compartilhamento
        function copyShareLink() {
            const input = document.getElementById('share-link-input');
            input.select();
            input.setSelectionRange(0, 99999);
            
            try {
                document.execCommand('copy');
                showToast('Link copiado! üìã', 'success');
                document.querySelector('.fixed.z-50').remove();
            } catch (err) {
                showToast('Erro ao copiar. Selecione e copie manualmente.', 'error');
            }
        }
        
        // Compartilhar no Facebook
        function shareToFacebook(link) {
            const facebookUrl = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(link)}`;
            window.open(facebookUrl, '_blank', 'width=600,height=400,noopener,noreferrer');
            showToast('Abrindo Facebook... üìò', 'success');
            document.querySelector('.fixed.z-50').remove();
        }
        
        // Compartilhar no Twitter
        function shareToTwitter(link) {
            const text = 'üçï Fa√ßa seu pedido online na Pizzaria Rodrigues! Pizzas deliciosas entregues na sua casa.';
            const twitterUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(text)}&url=${encodeURIComponent(link)}`;
            window.open(twitterUrl, '_blank', 'width=600,height=400,noopener,noreferrer');
            showToast('Abrindo Twitter... üê¶', 'success');
            document.querySelector('.fixed.z-50').remove();
        }
        
        // Compartilhar no Telegram
        function shareToTelegram(link) {
            const text = `üçï Pizzaria Rodrigues - Fa√ßa seu pedido online! ${link}`;
            const telegramUrl = `https://t.me/share/url?url=${encodeURIComponent(link)}&text=${encodeURIComponent('üçï Fa√ßa seu pedido online na Pizzaria Rodrigues!')}`;
            window.open(telegramUrl, '_blank', 'noopener,noreferrer');
            showToast('Abrindo Telegram... ‚úàÔ∏è', 'success');
            document.querySelector('.fixed.z-50').remove();
        }
        
        // Adicionar listeners para valida√ß√£o em tempo real
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
            
            // Listeners para todos os campos obrigat√≥rios
            const customerName = document.getElementById('customer-name');
            const deliveryAddress = document.getElementById('delivery-address');
            const customerWhatsapp = document.getElementById('customer-whatsapp');
            
            if (customerName) {
                customerName.addEventListener('input', updateCartDisplay);
            }
            if (deliveryAddress) {
                deliveryAddress.addEventListener('input', updateCartDisplay);
            }
            if (customerWhatsapp) {
                customerWhatsapp.addEventListener('input', updateCartDisplay);
            }
        });
    </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'995ba5ab41f0ba13',t:'MTc2MTY2NzIzNy4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
